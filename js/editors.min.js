var qreponses={},stylesheets={},myWindow,nbQ=1;CKEDITOR.disableAutoInline=!0;var lang=navigator.language||navigator.userLanguage;lang=lang.substring(0,2);var QCMCam={lang:{text:function(){var chaine=arguments[0];if(void 0!==arguments[1])for(var i=1;i<arguments.length;i++)chaine=chaine.replace("{}",arguments[i]);return chaine},translate:function(){var els,json,attr,chaine;QCMCam.lang.loadLang(!0)&&(CKEDITOR.config.language=lang,document.querySelectorAll("*[data-translate]").forEach(function(item){for(var i in json=JSON.parse(item.dataset.translate))attr=json[i].split("."),chaine=QCMCam.lang[lang][attr[0]][attr[1]],"html"===i?item.innerHTML=chaine:item[i]=chaine}),utils.isEmpty(CKEDITOR.instances)||QCMeditors.reloadCKEDITOR())},loadLang:function(force){if("fr"===lang&&void 0===force)return!1;if(["en","es","fr","de"].indexOf(lang)<0)return lang="fr",alert("Your language is not suported, default is french.\n\nYou can switch to Spanish, English or German\nin the bottom.\n\nOr you can help translating. See Info"),!1;if(void 0===QCMCam.lang[lang]){var script="js/lang/"+lang+".js",callback=function(){return!1};return force&&(callback=QCMCam.lang.translate),utils.addScript(script,callback),!1}return!0},changeLanguage:function(newlang){lang=newlang,QCMCam.lang.translate(!0)}}},utils={editQuestion:!0,findParentId:function(elt){for(var prt=elt.parentNode;prt.id.indexOf("editor")<0;)prt=prt.parentNode;return prt.id.substring(6)},montrerPasteUrl:function(TF){var elt=document.getElementById("pasteUrl"),elt2=document.getElementById("inputurl");TF?(elt.className="",elt2.focus(),elt2.value="",elt2.addEventListener("paste",utils.urlVerify)):(elt.className="cache",elt2.removeEventListener("paste",utils.urlVerify))},urlVerify:function(evt){var url=evt.clipboardData.getData("text/plain"),regex,regexDrive=/drive\.google\.com/,regexDropbox=/dropbox.com/;/^http/i.test(url)?(regexDrive.test(url)&&(url=url.replace("/open?","/uc?export=download&")),regexDropbox.test(url)&&(url=url.replace("dl=0","dl=1")),QCMeditors.loadFile(url)):alert(url+" n'est pas une url valide")},htmlToElement:function(html){var template=document.createElement("template");return template.innerHTML=html,template.content.firstChild},isEmpty:function(obj){var x;for(x in obj)return!1;return!0},removeElement:function(array,elem){var index=array.indexOf(elem);index>-1&&array.splice(index,1)},compareArrays:function(a1,a2){if(a1.length!==a2.length)return!1;for(var i=0;i<a1.length;i++)if(a2.indexOf(a1[i])<0)return!1;return!0},afficheAccueil:function(truefalse){void 0===truefalse&&(truefalse=!0),"cache"===utils.class("messageacceuil")&&truefalse?(utils.class("messageacceuil","flex"),utils.class("listeeleves","cache"),utils.class("boutonsuserslive","cache")):(utils.class("messageacceuil","cache"),utils.class("listeeleves",""),utils.class("boutonsuserslive",""))},pleinEcran:function(){screenfull.enabled&&screenfull.toggle()},select:function(elem){var range=document.createRange();range.selectNodeContents(elem);var selection=window.getSelection();selection.removeAllRanges(),selection.addRange(range)},getUrlVars:function(){for(var vars=[],hash,hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),len=hashes.length,i=0;i<len;i++)hash=hashes[i].split("="),vars.push(hash[0]),vars[hash[0]]=hash[1];return vars},lancerReveal:function(){utils.intervaldecompte=setInterval(utils.reveal,10)},reveal:function(){var decompte=Number(document.getElementById("intro").style.opacity);decompte<=.001?(document.getElementById("intro").style.display="none",clearInterval(utils.intervaldecompte)):document.getElementById("intro").style.opacity=decompte-.01},sortTable:function(n){var table,rows,switching,i,x,y,shouldSwitch,dir,switchcount=0;for(table=document.getElementById("tableau"),switching=!0,dir="asc";switching;){for(switching=!1,rows=table.getElementsByTagName("TR"),i=2;i<rows.length-1;i++)if(shouldSwitch=!1,x=rows[i].getElementsByTagName("TD")[n],y=rows[i+1].getElementsByTagName("TD")[n],"asc"===dir){if(this.isNumeric(x.innerHTML)&&this.isNumeric(y.innerHTML)){if(Number(x.innerHTML)>Number(y.innerHTML)){shouldSwitch=!0;break}}else if(x.innerHTML.toLowerCase()>y.innerHTML.toLowerCase()){shouldSwitch=!0;break}}else if("desc"===dir)if(this.isNumeric(x.innerHTML)&&this.isNumeric(y.innerHTML)){if(Number(x.innerHTML)<Number(y.innerHTML)){shouldSwitch=!0;break}}else if(x.innerHTML.toLowerCase()<y.innerHTML.toLowerCase()){shouldSwitch=!0;break}shouldSwitch?(rows[i].parentNode.insertBefore(rows[i+1],rows[i]),switching=!0,switchcount++):0===switchcount&&"asc"===dir&&(dir="desc",switching=!0)}},openLibrary:function(){void 0===myWindow?myWindow=window.open("bibliotheque.html","QCMCamLibrary","menubar=no,status=no,toolbar=no,scrollbars=yes"):myWindow.closed?(myWindow=window.open("bibliotheque.html","QCMCamLibrary","menubar=no,status=no,toolbar=no,scrollbars=yes")).focus():myWindow.focus()},closeLibrary:function(){void 0!==myWindow&&myWindow.close()},isNumeric:function(value){return/^-{0,1}\d+$/.test(value)},class:function(id,className){if(void 0===className)return document.getElementById(id).className;document.getElementById(id).className=className},addScript:function(src,callback){var s,r;r=!1,(s=document.createElement("script")).type="text/javascript",s.src=src,s.onload=s.onreadystatechange=function(){r||this.readyState&&"complete"!==this.readyState||(r=!0,callback())},document.head.appendChild(s)},renderKatex:function(eltId){for(var elTex=document.querySelectorAll("#"+eltId+" .math-tex"),i=0;i<elTex.length;i++){var textTex=elTex[i].innerHTML;try{katex.render(utils.decodeHtmlEntity(textTex.replace("\\(","").replace("\\)","")),elTex[i],{throwOnError:!1,errorColor:"#FFF"})}catch(err){elTex[i].innerHTML=err+" erreur de rendu avec "+textTex}}},revertKatex:function(eltId){for(var elKtex=document.querySelectorAll("#"+eltId+" .math-tex"),Tex=null,i=0;i<elKtex.length;i++)Tex=elKtex[i].querySelector("annotation").innerHTML,elKtex[i].innerHTML="\\("+Tex+"\\)"},decodeHtmlEntity:function(str){return(str=str.replace(/\&lt;/,"<")).replace(/\&gt;/,">")},encodeHtmlEntity:function(str){return buf.join("")},convertTimeToms:function(nb){if("number"==typeof nb&&nb>1e3){nb*=.001;var minutes=Math.floor(nb/60),secondes=nb%60;return nb=(minutes>=10?minutes:"0"+minutes)+":"+(secondes>=10?secondes:"0"+secondes)}return"string"==typeof nb&&nb.indexOf(":")>-1&&(nb=Math.round(6e4*Number(nb.substring(0,nb.indexOf(":")))+1e3*Number(nb.substring(nb.indexOf(":")+1))))},setChrono:function(id){var temps=document.getElementById("temps"+id).value;""!==temps&&"00:00"!==temps&&"00:00:00"!==temps?QCMeditors.times[id]=temps:delete QCMeditors.times[id]},startChrono:function(){if(!QCMeditors.times[QCMeditors.qFocusOn])return!1;document.getElementById("sablier").className="",utils.now=Date.now(),utils.endChrono=utils.now+utils.convertTimeToms(QCMeditors.times[QCMeditors.qFocusOn]),utils.duree=utils.endChrono-utils.now,document.getElementById("chronorect").style.width="100%",utils.intervalChrono=setInterval(utils.checkTime,100)},checkTime(){var now=Date.now(),barre=document.getElementById("chronorect"),decompte=document.getElementById("decompte");now>utils.endChrono?(utils.intervalChrono=null,barre.style.backgroundColor=null,barre.style.width=0,decompte.innerHTML="00:00"):(utils.endChrono-now>9825&&utils.endChrono-now<10075&&(barre.style.backgroundColor="red"),decompte.innerHTML=utils.convertTimeToms(1e3*Math.ceil(.001*(utils.endChrono-now))),barre.style.width=.01*Math.ceil((utils.endChrono-now)/utils.duree*1e4)+"%")},showSablier:function(value,id){console.log(value),""!==value&&utils.convertTimeToms(value)?QCMeditors.times[id]=value:QCMeditors.times[id]=void 0},storageAvailable:function(type){try{var storage=window[type],x="__storage_test__";return storage.setItem(x,x),storage.removeItem(x),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)}},toggleOptions:function(appelant,id){this.editQuestion?(QCMeditors.loadCKEDITOR(),QCMeditors.addStyle(),appelant.style.opacity=.5,this.editQuestion=!1):(this.editQuestion=!0,appelant.style.opacity=1,QCMeditors.unloadCKEDITOR(!0),QCMeditors.removeStyle())}};QCMCam.lang.loadLang();var QCMeditors={fileJustLoaded:!1,doRenderKatex:!1,qFocusOn:0,interval:null,animation:!1,reload:[],checkboxes:{},times:[],getContents:function(){QCMeditors.loadCKEDITOR();var content={},nq=0;for(var name in CKEDITOR.instances)content[nq]={question:CKEDITOR.instances[name].getData()},void 0!==qreponses[nq]&&(content[nq].reponse=qreponses[nq]),QCMeditors.times[nq]&&(content[nq].time=QCMeditors.times[nq]),nq++;return content},setEditable:function(yn){for(var elts=document.querySelectorAll("#editors .question"),i=0;i<elts.length;i++)elts[i].contentEditable=yn},setEditableTrue:function(){QCMeditors.setEditable(!0)},unloadCKEDITOR:function(doKatexRender,reload){var name;this.doRenderKatex=void 0===doKatexRender||doKatexRender;var listequestions=[];for(name in CKEDITOR.instances)void 0!==reload&&QCMeditors.reload.push(name),void 0===reload&&listequestions.push(CKEDITOR.instances[name].getData()),CKEDITOR.instances[name].destroy(!0);if(void 0===reload){for(var i=0;i<listequestions.length;i++)document.getElementById("editor"+i).innerHTML=listequestions[i],utils.renderKatex("editor"+i);QCMeditors.setEditable(!1),document.getElementById("editors").addEventListener("click",QCMeditors.loadCKEDITOR),QCMeditors.fileJustLoaded=!0}},loadCKEDITOR:function(editor){if(QCMeditors.fileJustLoaded&&(document.getElementById("editors").removeEventListener("click",QCMeditors.loadCKEDITOR),document.getElementById("editors").removeEventListener("mouseover",QCMeditors.setEditableTrue),utils.revertKatex("editors"),QCMeditors.fileJustLoaded=!1),"string"==typeof editor)void 0===CKEDITOR.instances[editor]&&(CKEDITOR.inline(editor),CKEDITOR.instances[editor].on("instanceReady",function(){QCMeditors.updateCheckAnwers(editor,editor.substring(6))}),CKEDITOR.instances[editor].on("instanceDestroyed",function(){QCMeditors.afterDestroy(editor,editor.substring(6))}),CKEDITOR.instances[editor].on("change",function(){QCMeditors.updateCheckAnwers(editor,editor.substring(6))}));else{var i,editors=document.querySelectorAll("#editors > .question");for(i=0;i<editors.length;i++)void 0===CKEDITOR.instances["editor"+i]&&(CKEDITOR.inline(editors[i]),CKEDITOR.instances["editor"+i].on("instanceReady",function(){QCMeditors.updateCheckAnwers(this.name,this.name.substring(6))}),CKEDITOR.instances["editor"+i].on("instanceDestroyed",function(){QCMeditors.afterDestroy(this.name)}),CKEDITOR.instances["editor"+i].on("change",function(){QCMeditors.updateCheckAnwers(this.name,this.name.substring(6))}))}QCMeditors.setEditable(!0)},reloadCKEDITOR:function(){QCMeditors.unloadCKEDITOR(!1,!0),setTimeout(QCMeditors.loadCKEDITOR,500)},afterDestroy:function(editor){this.doRenderKatex&&(utils.renderKatex(editor),QCMeditors.setEditable(!1)),this.reload.indexOf(editor)>-1&&(QCMeditors.loadCKEDITOR(editor),utils.removeElement(this.reload,editor))},updateCheckAnwers:function(editorID,id){var childs=document.querySelectorAll("#"+editorID+" ol > li"),elt=document.getElementById("btnchck"+id),lettres=["A","B","C","D"],check="",type="";elt.innerHTML="";for(var i=0;i<Math.min(4,childs.length);i++)check=void 0!==qreponses[id]&&qreponses[id].indexOf(lettres[i])>-1?' checked="checked" ':"",type=Array.isArray(qreponses[id])?"checkbox":"radio",elt.innerHTML+='<input type="'+type+'" name="reponse" value="'+lettres[i]+'" id="R'+lettres[i]+id+'" onclick="answers.setAnswer(this.value,this.type, '+id+');"'+check+" />"+lettres[i],childs[i].removeEventListener("click",QCMeditors.checkAnswer),childs[i].addEventListener("click",QCMeditors.checkAnswer,!0)},checkAnswer:function(evt){for(var deltax=0,imgBox,objBox=evt.target.getBoundingClientRect(),offset=objBox.left,id=utils.findParentId(evt.target),imgs=document.querySelectorAll("#editor"+id+" img"),i=0;i<imgs.length;i++)(imgBox=imgs[i].getBoundingClientRect()).left<=offset&&objBox.bottom>imgBox.top&&imgBox.bottom>objBox.top&&imgBox.width>deltax&&(deltax+=imgBox.width);var lettres=["A","B","C","D"],x=evt.clientX,value=Array.prototype.indexOf.call(evt.target.parentNode.children,evt.target),checkboxradio=document.getElementById("R"+lettres[value]+id);x-deltax-offset<28&&checkboxradio.click()},setAnimationWidth:function(){this.updatenbQ()},updatenbQ:function(){var elems=document.querySelectorAll(".question");nbQ=elems.length},renameEditors:function(rang){var e;if(void 0!==rang)for(var i=nbQ-1;i>=rang;i--)(e=document.getElementById("editor"+i)).id="editor"+(i+1);else{for(var alldivs=document.querySelectorAll("#editors > .question"),i=0;i<alldivs.length;i++)alldivs[i].id="editor"+i;this.reloadCKEDITOR()}},addQ:function(){var elem;document.getElementById("editors").innerHTML+=QCMeditors.insertCommandes(nbQ)+'<div id="editor'+nbQ+'" contenteditable="true" class="question"><h3>Question '+(nbQ+1)+"&nbsp;:</h3> <ol><li>&nbsp;</li></ol></div>",this.setAnimationWidth(),this.reloadCKEDITOR(),this.myMove("last")},prevQ:function(){0!==QCMeditors.qFocusOn&&this.myMove("r")},nextQ:function(){QCMeditors.qFocusOn!==nbQ-1&&this.myMove("l")},firstQ:function(){0!==QCMeditors.qFocusOn&&this.myMove("first")},lastQ:function(){QCMeditors.qFocusOn!==nbQ-1&&this.myMove("last")},supprQ:function(id){var contents=this.getContents(),newcontents={};delete contents[id];var increm=0;for(var obj in contents)newcontents[increm]=contents[obj],increm++;QCMeditors.replaceQuestions(newcontents)},insertCommandes:function(id){var txt='<div id="editionQuestions'+id+'" class="editionQuestions">';return txt+="<span class='numero'>"+(Number(id)+1)+"</span>",txt+='<img src="css/img/32px/if_file_add_66760.png" alt="Insérer" title="Insérer avant cette question" onclick="QCMeditors.insertQ('+id+');" data-translate=\'{"title":"questions.insertbefore"}\' />',txt+='<img src="css/img/32px/document-import.png" alt="Déplacer à gauche" title="Déplacer la question vers la gauche" onclick="QCMeditors.moveQLeft('+id+');" data-translate=\'{"title":"questions.movetoleft"}\' />',txt+='<img src="css/img/32px/document-export.png" alt="Déplacer à droite" onclick="QCMeditors.moveQRight('+id+');" title="Déplacer la question vers la droite" data-translate=\'{"title":"questions.movetoright"}\' />',txt+='<img src="css/img/32px/if_file_deny_66762.png" alt="Supprimer" title="Supprimer la question" onclick="QCMeditors.supprQ('+id+');" data-translate=\'{"title":"questions.deletequestion"}\' />',txt+='<img src="css/img/32px/if_folder_deny_66791.png" alt="Tout supprimer" title="Supprimer toutes les questions" onclick="QCMeditors.supprAllQ();" data-translate=\'{"title":"questions.deleteallquestions"}\' />',txt+='<label for="temps'+id+'" title="Temps pour apporter sa réponse" data-translate=\'{"title":"questions.timetoanswer"}\'>⏳</label><input type="time" value="00:00" min="00:00" step="60" id="temps'+id+'" name="temps'+id+'" title="Temps pour apporter sa réponse" data-translate=\'{"title":"questions.timetoanswer"}\' onchange="utils.showSablier(this.value,'+id+');" />',txt+="Type :",txt+='<input type="image" id=\'btncc'+id+"' onclick=\"QCMeditors.changeTypeChoice("+id+');" title="Commuter réponse simple/réponse multiple" data-translate=\'{"title":"questions.changetypechoice"}\' src="css/img/32px/onechoice.png" width="32" height="32" style="vertical-align: middle" />',txt+='<span data-translate=\'{"html":"questions.thegoodanswer"}\'>Bonne réponse</span> : <span id="btnchck'+id+"\"><input type='radio' name='reponse' value=\"A\" id='RA"+id+"' onclick=\"answers.setAnswer(this.value,this.type,"+id+');" />A<input type="radio" id="RB'+id+'" name="reponse" value="B" onclick="answers.setAnswer(this.value,this.type,'+id+');" />B',txt+='<input type="radio" id="RC'+id+'" name="reponse" value="C" onclick="answers.setAnswer(this.value,this.type,'+id+');" />C<input type="radio" id="RD'+id+'" name="reponse" value="D" onclick="answers.setAnswer(this.value,this.type,'+id+');" />D</span>',txt+='<input type="radio" id="R0'+id+'" name="reponse" title="pas de réponse" value="0" onclick="answers.setAnswer(this.value,this.type,'+id+');" />Ø',txt+="</div>"},insertQ:function(id){var contents=this.getContents(),increm=0,newcontent={};for(var obj in contents)String(obj)===String(id)&&(newcontent[increm]={question:"<h3>Question "+(increm+1)+" :</h3> <ol><li>&nbsp;</li></ol>"},increm++),newcontent[increm]=contents[obj],increm++;console.log(newcontent),QCMeditors.replaceQuestions(newcontent)},supprAllQ:function(){var elem;document.getElementById("editors").innerHTML='<div id="editor0" contenteditable="true" class="question"><h3>Question 1 :</h3> <ol><li>&nbsp;</li></ol></div>',qreponses={},totaux={A:0,B:0,C:0,D:0},nbQ=1,QCMeditors.qFocusOn=0,this.setAnimationWidth(),this.updateNav(),this.reloadCKEDITOR(),answers.resetAll()},moveQLeft:function(id){if(0===id)return!1;var contents=this.getContents(),temp=contents[id-1];contents[id-1]=contents[id],contents[id]=temp,QCMeditors.replaceQuestions(contents)},moveQRight:function(id){if(id>nbQ-1)return!1;var contents=this.getContents(),temp=contents[id+1];contents[id+1]=contents[id],contents[id]=temp,QCMeditors.replaceQuestions(contents)},updateNav:function(){this.updatenbQ();for(var id=0;id<nbQ;id++){QCMeditors.updateCheckAnwers("editor"+id,id);var reponseset=qreponses[id];if(QCMeditors.times[id]?document.getElementById("temps"+id).value=QCMeditors.times[id]:document.getElementById("temps"+id).value="00:00",void 0!==reponseset){if("string"==typeof reponseset)QCMeditors.changeTypeChoice(id,"radio"),document.getElementById("R"+reponseset+id).checked=!0;else if(Array.isArray(reponseset)){QCMeditors.changeTypeChoice(id,"checkbox");for(var elems=document.querySelectorAll("#editionQuestions"+id+" input[name='reponse']"),i=0;i<elems.length;i++)elems[i].checked=!1;if(reponseset.length>0)for(var i=0;i<reponseset.length;i++)document.getElementById("R"+reponseset[i]+id).checked=!0;else elems[i-1].checked=!0}QCMeditors.addStyle(id)}else QCMeditors.changeTypeChoice(id,"radio")}},myMove:function(direction){return!0!==QCMeditors.animation&&((0!==QCMeditors.qFocusOn||"r"!==direction)&&((QCMeditors.qFocusOn!==nbQ-1||"l"!==direction)&&void(QCMeditors.animation=!0)))},setQuestionsWidth:function(){var divs=document.getElementsByClassName("question");if(divs.length>0){var percentLength=1/divs.length*100,i=0;for(i=0;i<divs.length;i++)divs[i].style.width=percentLength+"%"}return!0},download:function(){var content=QCMeditors.getContents(),nomfichier;content=JSON.stringify(content),utils.storageAvailable("localStorage")&&content.length<25e5&&(nomfichier=QCMeditors.saveToLocalStorage(content));var contentType,filename=null!=nomfichier&&""!==nomfichier?nomfichier+".txt":"questions.txt",blob=new Blob([content],{type:"text/plain"});download(blob,filename,"text/plain")},saveToLocalStorage:function(content,nomfichier){var lastcontent={},filename;if(void 0!==nomfichier&&(filename=nomfichier),void 0!==localStorage.lastQ){var tailleOK=(localStorage.lastQ+content).length<25e5;if(lastcontent=JSON.parse(localStorage.lastQ),!tailleOK){var tempmin=1/0;for(var i in lastcontent)Number(i)<tempmin&&(tempmin=Number(i)),lastcontent[i].name===nomfichier&&delete lastcontent[i];delete lastcontent[tempmin]}}return void 0===filename&&(filename=window.prompt("Quel nom pour votre questionnaire ?\n(laisser vide ou Annuler pour ne pas garder en mémoire)")),null!==filename&&""!==filename&&(lastcontent[Date.now()]={name:filename+(void 0!==nomfichier?"":".txt"),content:content},localStorage.lastQ=JSON.stringify(lastcontent)),filename},openFile:function(event){var input=event.target,reader=new FileReader;reader.onload=function(){utils.storageAvailable("localStorage")&&reader.result.length<25e5&&QCMeditors.saveToLocalStorage(reader.result,input.files[0].name),QCMeditors.replaceQuestions(reader.result)},reader.readAsText(input.files[0])},loadLastQCM:function(){if(void 0!==localStorage.lastQ&&"{}"!==localStorage.lastQ){var questionnaires=JSON.parse(localStorage.lastQ),cpt=0,id;for(var i in questionnaires)cpt++,id=i;if(id<1e4){var temp=localStorage.lastQ;delete localStorage.lastQ,QCMeditors.saveToLocalStorage(temp,"Ancien historique"),QCMeditors.replaceQuestions(temp)}else if(cpt>=1){utils.class("lastcontents","");var el=document.getElementById("lc-content"),chaine="<ul>";for(var i in questionnaires)chaine+='<li><span onclick="QCMeditors.insertHistoricalQCM('+i+');">'+questionnaires[i].name+'</span> - <input type="image" src="css/img/process-stop.png" onclick="QCMeditors.deleteThisHistorique('+i+')"></li>';chaine+="</ul>",el.innerHTML=chaine}}else utils.class("lastcontents","cache"),utils.class("btnrq","cache")},insertHistoricalQCM:function(id){var quests=JSON.parse(localStorage.lastQ);QCMeditors.replaceQuestions(quests[id].content)},deleteThisHistorique:function(id){var quests=JSON.parse(localStorage.lastQ);delete quests[id],localStorage.lastQ=JSON.stringify(quests),QCMeditors.loadLastQCM()},addStyle:function(questionNumber){if(void 0!==qreponses[questionNumber]){var s=[],se=null;if(null!==document.getElementById("stylesheet"+questionNumber)&&(se=document.getElementById("stylesheet"+questionNumber)),qreponses[questionNumber].indexOf("A")>-1&&s.push(1),qreponses[questionNumber].indexOf("B")>-1&&s.push(2),qreponses[questionNumber].indexOf("C")>-1&&s.push(3),qreponses[questionNumber].indexOf("D")>-1&&s.push(4),!s.length)return QCMeditors.removeStyle(questionNumber),!1;var sheet=document.createElement("style");sheet.id="stylesheet"+questionNumber;for(var i=0;i<s.length;i++)sheet.innerHTML+="#editor"+questionNumber+" ol > li:nth-child("+s[i]+")::before{border-radius:20px 20px 20px 20px;border:3px solid green;}";stylesheets[questionNumber]?document.body.replaceChild(sheet,se):document.body.appendChild(sheet),stylesheets[questionNumber]="sstylesheet"+questionNumber}else QCMeditors.removeStyle(questionNumber)},removeStyle:function(questionNumber){var sheet=document.getElementById("stylesheet"+questionNumber),sheetParent;if(!sheet)return!1;sheet.parentNode.removeChild(sheet),delete stylesheets[questionNumber]},loadFile:function(url){var reader=new XMLHttpRequest;reader.onload=function(){QCMeditors.replaceQuestions(reader.responseText)},reader.open("get","phploader.php?url="+encodeURIComponent(url),!0),reader.send(),void 0!==myWindow&&myWindow.close()},replaceQuestions:function(json){QCMeditors.unloadCKEDITOR(),utils.class("lastcontents","cache");var questionsreponses={},i;if("string"==typeof json)if(json.indexOf("|#|")>-1){var qr=json.split("|json|"),qs=qr[0].split("|#|");for(qr=void 0!==qr[1]?JSON.parse(qr[1]):{},i=0;i<qs.length;i++)questionsreponses[i]={question:qs[i],reponse:qr[i]}}else questionsreponses=JSON.parse(json);else questionsreponses=json;var elem=document.getElementById("editors");for(i in qreponses={},elem.innerHTML="",nbQ=0,QCMeditors.times=[],questionsreponses)void 0!==questionsreponses[i].time&&(QCMeditors.times[i]=questionsreponses[i].time),nbQ++,""!==questionsreponses[i].question&&(elem.innerHTML+=QCMeditors.insertCommandes(i)+'<div id="editor'+i+'" contenteditable="false" class="question">'+questionsreponses[i].question+"</div>"),void 0!==questionsreponses[i].reponse&&(qreponses[Number(i)]=questionsreponses[i].reponse);if(utils.renderKatex("editors"),QCMeditors.qFocusOn=0,this.setAnimationWidth(),this.updateNav(),void 0!==questionsreponses.size){var styleQuestions=document.getElementById("questions").style;styleQuestions.width=questionsreponses.size.width,styleQuestions.height=questionsreponses.size.height}QCMeditors.fileJustLoaded=!0,document.getElementById("editors").addEventListener("click",QCMeditors.loadCKEDITOR),document.getElementById("editors").addEventListener("mouseover",QCMeditors.setEditableTrue)},toggleCacheQuestions:function(state){var cache=document.getElementById("cacheQuestions"),widthQ=document.getElementById("questions").offsetWidth;cache.style.width=widthQ+"px","cache"===cache.className&&void 0===state||"show"===state?cache.className="montre":cache.className="cache"},changeTypeChoice:function(id,what){var btn=document.getElementById("btncc"+id),elems=document.querySelectorAll("#editionQuestions"+id+" input[name='reponse']");if(void 0===what&&"radio"===elems[0].type||"checkbox"===what){for(var i=0;i<elems.length;i++)elems[i].type="checkbox";if(void 0===what||void 0===qreponses[id]){qreponses[id]=[];for(var i=0;i<elems.length;i++)elems[i].checked&&i<4&&qreponses[id].push(elems[i].value)}btn.src="css/img/32px/multiplechoice.png"}else{btn.src="css/img/32px/onechoice.png";for(var i=0;i<elems.length;i++)elems[i].type="radio",elems[i].checked=!1;elems[i-1].checked=!0,void 0===what&&delete qreponses[id]}QCMeditors.addStyle(id)},setItemsiFrameDialog:function(dialog,evt){if(dialog&&evt){var theiframe=null,div=document.createElement("DIV");div.innerHTML=evt.clipboardData.getData("text/plain"),(theiframe=div.querySelector("iframe"))&&(void 0!==theiframe.src&&setTimeout(function(){dialog.setValueOf("info","src",theiframe.src)},50),void 0!==theiframe.width&&dialog.setValueOf("info","width",theiframe.width),void 0!==theiframe.height&&dialog.setValueOf("info","height",theiframe.height),void 0!==theiframe.name&&dialog.setValueOf("info","name",theiframe.name))}}},answers={setAnswer:function(value,type,id){if("radio"===type)"0"!==value?qreponses[id]=value:delete qreponses[id];else if("0"!==value){var elem=document.querySelector("#editionQuestions"+id+" input[name='reponse'][value='0']");elem.checked=!1,(elem=document.querySelector("#editionQuestions"+id+" input[name='reponse'][value='"+value+"']")).checked?qreponses[id].push(value):utils.removeElement(qreponses[id],value)}else{var elems=document.querySelectorAll("#editionQuestions"+id+" input[name='reponse']");qreponses[id]=[];for(var i=0;i<elems.length-1;i++)elems[i].checked=!1}QCMeditors.addStyle(id)},resetAll:function(){var i;for(i in this.initAll(),stylesheets)QCMeditors.removeStyle(i)},initAll:function(move){void 0===move&&(move=!0),void 0===stylesheets[QCMeditors.qFocusOn]||move||QCMeditors.removeStyle(QCMeditors.qFocusOn)}};function onLoad(){if(document.getElementById("temps0").value="00:00",liendirect=location.href.indexOf("?"),liendirect>0){var paramsLien=utils.getUrlVars();void 0!==paramsLien.lang&&(lang=paramsLien.lang,QCMCam.lang.translate()),void 0!==paramsLien.url&&QCMeditors.loadFile(location.href.substring(location.href.indexOf("url=")+4))}else utils.storageAvailable("localStorage")&&void 0!==localStorage.lastQ&&"{}"!==localStorage.lastQ&&utils.class("btnrq","");liendirect<0&&"fr"!==lang&&QCMCam.lang.translate(),liendirect<0&&QCMeditors.loadCKEDITOR(),setTimeout(utils.lancerReveal,1e3),document.onkeydown=function(evt){if(evt.altKey)switch(evt.keyCode){case 75:users.alea();break;case 73:utils.Infos("open");break;case 90:utils.pleinEcran();break;case 71:QCMeditors.nextQ();break;case 86:users.afficheReponses();break;case 82:answers.initAll();break;case 88:QCMeditors.addQ()}},document.onkeyup=function(evt){if(164===evt.keyCode){var editor=CKEDITOR.instances["editor"+evt.target.id.substring(6)],content=editor.getData();content.split("$$").length-1==2&&(content=content.replace(/\$\$([^$]*)\$\$/i,'<span class="math-tex">\\($1\\)</span> <span id="bukmrk">.</span>'),editor.setData(content,function(){var element=editor.document.getById("bukmrk"),selection=editor.getSelection(),range;selection.selectElement(element),selection.getRanges()[0].select(),element.remove()}))}}}window.onload=onLoad;